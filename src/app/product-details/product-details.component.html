<section id="product-details">
  <div *ngIf="product">
    <div class="md-wrapper:hidden">
      <div #swiperContainerSingleProduct class="swiper h-[540px]">
        <div class="swiper-wrapper">
          <div *ngFor="let image of product.images" class="swiper-slide">
            <img
              (load)="onImageLoaded()"
              [src]="image.url"
              [alt]="product.name"
              class="object-cover w-full h-full no-drag"
            />
          </div>
        </div>
        <div
          class="swiper-button-prev ml-4 keen-arrow product-details-navigation-prev text-black absolute left-0 top-1/2 -translate-y-1/2 z-30 rounded-full w-8 h-8 flex justify-center items-center hover:bg-[#515b5d] hover:text-white bg-[#f9f9f9] select-none"
        >
          <span class="material-symbols-outlined thin-icon">chevron_left</span>
        </div>
        <div
          class="swiper-button-next mr-4 keen-arrow product-details-navigation-next text-black absolute right-0 top-1/2 -translate-y-1/2 z-30 rounded-full w-8 h-8 flex justify-center items-center hover:bg-[#515b5d] hover:text-white bg-[#f9f9f9] select-none"
        >
          <span class="material-symbols-outlined thin-icon">chevron_right</span>
        </div>
      </div>
      <div class="flex justify-center w-full">
        <div
          class="swiper-pagination product-details-swiper-pagination h-9 flex justify-center items-center !bottom-auto"
        ></div>
      </div>
    </div>
  </div>
  <div class="wrapper my-8">
    <div
      *ngIf="product"
      class="grid grid-cols-1 md-wrapper:grid-cols-2 max-w-[1132px] mx-auto gap-[84px]"
    >
      <div class="select-none hidden md-wrapper:block">
        <div class="relative">
          <img
            [src]="product.images[0].url"
            [alt]="product.name"
            (load)="onImageLoaded()"
            class="w-[524px] h-[524px] object-cover rounded select-none no-drag"
          />
          <div
            *ngIf="product.featured"
            class="absolute capitalize z-30 top-4 left-4 bg-[#edf3f6] rounded-3xl py-1.5 px-4 text-[12px] font-text select-none"
          >
            bestseller
          </div>
        </div>
        <div class="grid grid-cols-2 gap-2 mt-2">
          <div *ngFor="let image of product.images | slice : 1">
            <img
              (load)="onImageLoaded()"
              [src]="image.url"
              [alt]="product.name"
              class="w-[258px] h-[258px] object-cover rounded no-drag"
            />
          </div>
        </div>
      </div>

      <div>
        <h1 class="text-[32px] font-normal capitalize text-center font-title">
          {{ product.name }}
        </h1>
        <p class="text-center text-[20px] font-title">Signature Collection</p>
        <h2 class="capitalize text-center">company â€¢ {{ product.company }}</h2>

        <div class="choice-block">
          <div class="my-2">
            <input
              type="radio"
              name="buy_type"
              value="one_time"
              id="buy-type"
              class="hidden"
              [(ngModel)]="selectedBuyType"
              checked
            />
            <label
              for="buy-type"
              class="border-[#e2e1e1] flex items-center gap-1 text-center cursor-pointer text-black py-4 px-6 rounded-sm font-text transition-all duration-300 ease-out text-sm font-normal border"
            >
              <span
                class="radio-circle w-6 h-6 border border-black rounded-full mr-2 p-0.5 transition-all duration-[350ms] ease-in"
              ></span>
              One Time Purchase
              <span class="ml-auto">
                <span>${{ product.price / 100 | number : "1.0-2" }}</span>
              </span>
            </label>
          </div>
          <div class="my-2">
            <input
              type="radio"
              name="buy_type"
              value="Subscribe"
              id="buy-type_0"
              class="hidden"
              [(ngModel)]="selectedBuyType"
            />
            <label
              for="buy-type_0"
              class="border-[#e2e1e1] flex items-center gap-1 text-center cursor-pointer text-black py-4 px-6 rounded-sm font-text transition-all duration-300 ease-out text-sm font-normal border"
            >
              <span
                class="radio-circle w-6 h-6 border border-black rounded-full mr-2 p-0.5 transition-all duration-[350ms] ease-in"
              ></span>
              Subscribe & Save 10%
              <span class="ml-auto">
                <span>
                  ${{ (product.price * 0.9) / 100 | number : "1.0-2" }}</span
                >
                <span class="line-through text-[#6A6A6A] ml-2">
                  ${{ product.price / 100 | number : "1.0-2" }}
                </span>
              </span>
            </label>
          </div>

          <div>
            <div
              class="supscription"
              [class.hidden]="selectedBuyType !== 'Subscribe'"
            ></div>
            <div
              class="gift-wrap"
              [class.hidden]="selectedBuyType === 'Subscribe'"
            >
              <input
                type="checkbox"
                name="gift_wrap"
                value="gift"
                id="gift_wrap"
                class="gift-checkbox hidden"
              />
              <label
                for="gift_wrap"
                class="gift-wrap border-[#e2e1e1] flex items-center gap-1 text-center cursor-pointer text-black py-4 px-6 rounded-sm font-text transition-all duration-300 ease-out text-sm font-normal border"
              >
                <span
                  class="radio-square text-base flex items-center w-6 h-6 rounded-xs border border-black mr-2 p-0.5 transition-all duration-[350ms] ease-in"
                ></span>
                Add gift wrapping for $9.00
              </label>
            </div>
          </div>
        </div>
        <app-button
          class="flex-1"
          [paddingX]="'px-2.5'"
          [paddingY]="'py-2.5'"
          [style]="'primary'"
          [wFull]="true"
          >Add to Cart</app-button
        >

        <div class="single-product-menu">
          @for (section of menuSections; track section.title; let i = $index) {
          <div class="w-full border-b border-gray-footer-line">
            <div
              class="uppercase mb-4 text-sm py-[18px] cursor-pointer flex items-center justify-between"
              (click)="toggleSection(i)"
            >
              {{ section.title }}
              <span
                class="ml-2 rounded-full flex items-center bg-[#f7f7f7] transition-transform duration-300 select-none"
                [class.rotate-180]="expandedSections[i]"
                ><span class="material-symbols-outlined">
                  keyboard_arrow_down
                </span></span
              >
            </div>
            <div
              class="overflow-hidden transition-max-height duration-[.4s] ease-in-out"
              [style.maxHeight]="expandedSections[i] ? '500px' : '0px'"
            >
              <ul class="mt-2">
                @for (item of section.items; track item) {
                <li class="capitalize mb-4 text-[12px]">{{ item }}</li>
                }
              </ul>
            </div>
          </div>
          }
        </div>
      </div>
    </div>
  </div>
  <div class="usp-banner">
    <div class="bg-[#f6f2ed] my-16 p-10">
      <div class="max-w-[375px] md-wrapper:max-w-[1360px] mx-auto">
        <ul class="flex flex-col md-wrapper:flex-row gap-2">
          <li
            class="flex items-center justify-between w-[100%] gap-2 text-center font-text text-[12px] font-normal uppercase md-wrapper:flex-col md-wrapper:content-center md-wrapper:w-[25%] md-wrapper:gap-1"
          >
            style
            <span class="md-wrapper:text-base capitalize text-sm">Modern</span>
          </li>
          <li
            class="flex items-center justify-between w-[100%] gap-2 text-center font-text text-[12px] font-normal uppercase md-wrapper:flex-col md-wrapper:content-center md-wrapper:w-[25%] md-wrapper:gap-1"
          >
            material
            <span class="md-wrapper:text-base capitalize text-sm"
              >Oak Wood</span
            >
          </li>
          <li
            class="flex items-center justify-between w-[100%] gap-2 text-center font-text text-[12px] font-normal uppercase md-wrapper:flex-col md-wrapper:content-center md-wrapper:w-[25%] md-wrapper:gap-1"
          >
            finish
            <span class="md-wrapper:text-base capitalize text-sm">Matte</span>
          </li>
          <li
            class="flex items-center justify-between w-[100%] gap-2 text-center font-text text-[12px] font-normal uppercase md-wrapper:flex-col md-wrapper:content-center md-wrapper:w-[25%] md-wrapper:gap-1"
          >
            assembly
            <span class="md-wrapper:text-base capitalize text-sm"
              >required</span
            >
          </li>
        </ul>
      </div>
    </div>
  </div>
  <app-cta
    [paddingY]="true"
    [textPaddingLefth]="true"
    headline="Discover the Champagne of Furniture"
    subheadline="VelvetCrest Signature Collection"
    description="Renowned across the design world for its unmatched craftsmanship and elegant, timeless aesthetics, the VelvetCrest Signature Collection has earned its place as 'The Champagne of Furniture'. Considered one of the finest examples of contemporary design, each piece in the collection is crafted under rigorous standards using sustainably sourced materials and meticulous detailing.

The VelvetCrest studio, nestled in a serene, heritage-rich region, benefits from a setting that inspires creativity and precision. Shaped by skilled artisans where natural light, calm surroundings, and a passion for excellence come together, every item in the collection reflects a tradition of quality that has stood the test of time."
    [images]="[{ src: '/single-product-cta.jpg', alt: 'Mexico City Opal 1' }]"
    [reverseLayout]="false"
    [showSeparator]="true"
    bgColor="null"
    innerBg="bg-seashell"
    [showBtn]="false"
    customPaddingCtaText="cta-padding-single-product"
  ></app-cta>
  <app-cta
    *ngIf="product?.featured"
    [paddingY]="true"
    [textPaddingLefth]="true"
    headline="Discover the Champagne of Furniture"
    subheadline="VelvetCrest Signature Collection"
    description="Renowned across the design world for its unmatched craftsmanship and elegant, timeless aesthetics, the VelvetCrest Signature Collection has earned its place as 'The Champagne of Furniture'. Considered one of the finest examples of contemporary design, each piece in the collection is crafted under rigorous standards using sustainably sourced materials and meticulous detailing.

The VelvetCrest studio, nestled in a serene, heritage-rich region, benefits from a setting that inspires creativity and precision. Shaped by skilled artisans where natural light, calm surroundings, and a passion for excellence come together, every item in the collection reflects a tradition of quality that has stood the test of time."
    [images]="[{ src: '/single-product-cta_1.jpg', alt: 'Mexico City Opal 1' }]"
    [reverseLayout]="true"
    [showSeparator]="true"
    bgColor="null"
    innerBg="bg-seashell"
    [showBtn]="false"
    customPaddingCtaText="cta-padding-single-product"
  ></app-cta>

  <div class="wrapper">
    <div class="my-12">
      <div class="w-full flex justify-center">
        <h3
          class="font-title max-w-[80%] md-wrapper:max-w-full text-[22px] md-wrapper:text-[30px] mb-6 text-center"
        >
          See what people are saying about {{ product?.name }}!
        </h3>
      </div>
      <div
        class="md-wrapper:grid gap-2 md-wrapper:grid-cols-4 max-[1240px]:grid-cols-3"
      >
        <div
          id="testimonials-swiper"
          *ngIf="isMobile; else desktopTestimonials"
          class="swiper testimonials-product-reviews-swiper"
        >
          <div class="swiper-wrapper">
            @for (testimonial of testimonials; track testimonial.id) {
            <app-card
              class="swiper-slide"
              [id]="testimonial.id"
              [testimonial]="testimonial.testimonial"
              [author]="testimonial.author"
            ></app-card>
            }
          </div>
          <div class="flex justify-center w-full">
            <div
              class="swiper-pagination testimonials-product-reviews-pagination progress-pagination"
            ></div>
          </div>
        </div>

        <ng-template #desktopTestimonials>
          @for (testimonial of testimonials; track testimonial.id) {
          <app-card
            [id]="testimonial.id"
            [testimonial]="testimonial.testimonial"
            [author]="testimonial.author"
          ></app-card>
          }
        </ng-template>
      </div>
    </div>
  </div>
</section>
