<div class="search-container max-w-[1132px] mx-auto p-4 bg-gray-900 text-white">
  <div class="mb-6">
    <h2 class="font-lora text-xl">
      Search results for "{{ searchTerm || "all products" }}"
      <span *ngIf="searchResults.length > 0">
        {{ searchResults.length }} result{{
          searchResults.length === 1 ? "" : "s"
        }}
        found
      </span>
      <span *ngIf="searchResults.length === 0 && searchTerm">
        0 results found
      </span>
    </h2>
  </div>

  <div class="flex flex-col md:flex-row gap-4 mb-6">
    <div class="flex flex-wrap gap-4 items-center">
      <label class="text-sm font-poppins">Category:</label>
      <select
        [(ngModel)]="selectedCategory"
        (change)="onFilterChange()"
        class="p-2 border rounded text-black capitalize"
      >
        <option class="capitalize" *ngFor="let cat of categories" [value]="cat">
          {{ cat }}
        </option>
      </select>

      <label class="text-sm font-poppins">Company:</label>
      <select
        [(ngModel)]="selectedCompany"
        (change)="onFilterChange()"
        class="p-2 border rounded text-black capitalize"
      >
        <option *ngFor="let comp of companies" [value]="comp">
          {{ comp }}
        </option>
      </select>

      <label class="text-sm font-poppins">Color:</label>
      <div class="relative w-28">
        <div
          class="border rounded p-2 flex items-center justify-between cursor-pointer"
          (click)="toggleColorDropdown()"
        >
          <div class="flex items-center gap-2">
            <div
              *ngIf="selectedColor !== 'All'"
              class="w-4 h-4 rounded-full border"
              [ngStyle]="{ 'background-color': selectedColor }"
            ></div>
            <span>{{ getColorLabel(selectedColor) }}</span>
          </div>
          <span class="material-symbols-outlined">expand_more</span>
        </div>

        <div
          *ngIf="showColorDropdown"
          class="absolute left-0 w-full border text-black bg-white mt-1 rounded shadow z-50"
        >
          <div
            *ngFor="let c of colors"
            (click)="selectColor(c)"
            class="flex items-center gap-2 p-2 hover:bg-gray-100 cursor-pointer"
          >
            <div
              *ngIf="c !== 'all'"
              class="w-4 h-4 rounded-full"
              [ngStyle]="{ 'background-color': c }"
            ></div>
            <span>{{ getColorLabel(c) }}</span>
          </div>
        </div>
      </div>

      <label class="text-sm font-poppins flex items-center gap-1">
        <input
          type="checkbox"
          [(ngModel)]="freeShippingOnly"
          (change)="onFilterChange()"
        />
        Free Shipping
      </label>
    </div>

    <div class="flex items-center gap-2 ml-auto">
      <label for="sort" class="font-poppins text-sm">Sort By:</label>
      <select
        id="sort"
        [(ngModel)]="sortBy"
        (ngModelChange)="onSortChange()"
        class="p-2 border rounded font-poppins text-sm bg-white text-black"
      >
        <option *ngFor="let option of sortOptions" [value]="option.value">
          {{ option.label }}
        </option>
      </select>
    </div>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    <div
      *ngFor="let product of searchResults"
      class="product-card bg-white text-black p-4 rounded shadow-md hover:bg-seashell transition-colors"
    >
      <img
        [src]="product.image"
        [alt]="product.name"
        class="w-full h-48 object-cover rounded-t"
      />
      <div class="p-2">
        <h3 class="font-lora text-lg">{{ product.name }}</h3>
        <p class="text-yellow-600 text-sm">
          ${{ product.price / 100 | number : "1.0-2" }}
        </p>
        <button
          (click)="onViewDetails(product)"
          class="mt-2 p-2 bg-dark-slate-green text-white rounded hover:bg-opacity-90 transition-colors w-full"
        >
          View Details
        </button>
      </div>
    </div>
  </div>

  <p
    *ngIf="searchTerm && searchResults.length === 0"
    class="text-gray-500 text-sm mt-4"
  >
    No results found.
  </p>
</div>
